"use strict";(self["webpackChunknow_playing"]=self["webpackChunknow_playing"]||[]).push([[186],{5186:function(e,n,t){t.r(n),t.d(n,{default:function(){return d}});var o=t(6768),i=t(4232);const r={class:"callback-container"},s={key:0,class:"loading"},a={key:1,class:"error-message"};function c(e,n,t,c,l,u){return(0,o.uX)(),(0,o.CE)("div",r,[l.loading?((0,o.uX)(),(0,o.CE)("div",s,n[2]||(n[2]=[(0,o.Lk)("div",{class:"spinner"},null,-1),(0,o.Lk)("p",null,"Connecting to Spotify...",-1)]))):(0,o.Q3)("",!0),l.error?((0,o.uX)(),(0,o.CE)("div",a,[(0,o.Lk)("p",null,(0,i.v_)(l.error),1),(0,o.Lk)("button",{onClick:n[0]||(n[0]=(...e)=>u.returnToLogin&&u.returnToLogin(...e)),class:"retry-button"},"Return to Login"),l.showDiagnostics?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:n[1]||(n[1]=(...e)=>u.runDiagnostics&&u.runDiagnostics(...e)),class:"retry-button diagnostics-button"}," Run Diagnostics ")):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)])}t(4114);var l={name:"CallbackPage",data(){return{loading:!0,error:null,showDiagnostics:!1}},created(){this.handleCallback()},methods:{async handleCallback(){const e=new URLSearchParams(window.location.search),n=e.get("code"),o=e.get("error");if(o)return this.error=`Spotify authentication error: ${o}`,void(this.loading=!1);if(!n)return this.error="No authorization code received from Spotify",void(this.loading=!1);try{const{exchangeCodeForToken:e}=await t.e(954).then(t.bind(t,3954)),o="http://localhost:8080/callback";console.log("Using redirect URI:",o);const i=await e(n,o);console.log("Token exchange successful"),this.$store.commit("setToken",i.access_token),this.$store.commit("setRefreshToken",i.refresh_token),this.$router.push("/")}catch(o){console.error("Authentication error:",o),o.message.includes("invalid_client")||o.message.includes("401")?(this.error="Authentication failed: Invalid client credentials. Please check the configuration.",this.showDiagnostics=!0):this.error=`Authentication error: ${o.message}`,this.loading=!1}},returnToLogin(){this.$router.push("/login")},runDiagnostics(){this.$router.push("/diagnostics")}}},u=t(1241);const h=(0,u.A)(l,[["render",c],["__scopeId","data-v-e4743d58"]]);var d=h}}]);
//# sourceMappingURL=186.43150155.js.map